# نظام رموز QR للشاليهات

## نظرة عامة
هذا النظام يسمح للعملاء وأصحاب الشاليهات باستخدام رموز QR لتسهيل عملية تسجيل الدخول والخروج.

## للعملاء (الضيوف)

### 1. إنشاء رمز QR
- عند حجز الشاليه، يتم إنشاء رمز فريد لكل ضيف (6 أحرف وأرقام)
- يمكن للعميل عرض رموز QR من صفحة قائمة الضيوف
- كل رمز يحتوي على معلومات التحقق الخاصة بالضيف

### 2. عرض رمز QR
- اذهب إلى صفحة الحجز الناجح
- اضغط على "قائمة الضيوف" 
- اضغط على زر "عرض QR" بجانب اسم كل ضيف
- سيظهر رمز QR في نافذة منبثقة

### 3. استخدام الرمز
- احفظ صورة رمز QR على هاتفك
- عند الوصول للشاليه، اعرض الرمز للمالك للمسح

## لأصحاب الشاليهات

### 1. الوصول لماسح QR
- من القائمة الرئيسية، اضغط على "ماسح QR"
- يتطلب تسجيل الدخول كمالك شاليه

### 2. المسح الضوئي
- اضغط على "بدء المسح" لتفعيل الكاميرا
- وجه الكاميرا إلى رمز QR الخاص بالضيف
- سيتم التحقق تلقائياً وعرض معلومات الضيف

### 3. الإدخال اليدوي
- إذا فشل المسح، يمكن إدخال الرمز يدوياً
- أدخل الرمز المكون من 6 أحرف (مثال: ABC123)
- اضغط على "تحقق"

### 4. تسجيل الدخول والخروج
- **تسجيل الدخول**: اضغط على "تسجيل الدخول" عند وصول الضيف
- **تسجيل الخروج**: اضغط على "تسجيل الخروج" عند مغادرة الضيف
- يتم تسجيل الوقت والتاريخ تلقائياً

## المميزات

### للعملاء
- رموز فريدة لكل ضيف
- سهولة الوصول والطباعة
- معلومات مؤمنة ومشفرة

### لأصحاب الشاليهات
- مسح سريع وسهل
- تحقق فوري من صحة الحجز
- سجل كامل للدخول والخروج
- واجهة محمول متجاوبة

## الأمان
- الرموز صالحة فقط للحجوزات المؤكدة
- التحقق من ملكية الشاليه قبل السماح بالمسح
- تسجيل جميع عمليات المسح

## المتطلبات التقنية

### المكتبات المضافة
- `qrcode[pil]==7.4.2` لإنشاء رموز QR
- مكتبة `html5-qrcode` للمسح الضوئي في المتصفح

### النماذج المحدثة
- `BookingGuest` تمت إضافة حقول `checkin_time` و `checkout_time`

### المسارات الجديدة
- `/booking/scanner/` - واجهة الماسح
- `/api/guest-qr/<code>/` - إنشاء رمز QR
- `/api/verify-guest/<code>/` - التحقق من الرمز
- `/api/verify-guest-action/` - تسجيل الدخول/الخروج

## استكشاف الأخطاء

### مشاكل شائعة
1. **الكاميرا لا تعمل**: تحقق من إذن الوصول للكاميرا
2. **الرمز لا يقرأ**: تأكد من إضاءة جيدة ورمز واضح
3. **التحقق يفشل**: تأكد من أن الحجز مؤكد والضيف مسجل

### حلول بديلة
- استخدم الإدخال اليدوي للرمز
- تحقق من حالة الحجز من لوحة التحكم
- اتصل بالدعم الفني إذا استمرت المشكلة
